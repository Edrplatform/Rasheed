<div dir="rtl">

# ูุดุฑูุน Rasheed - ูุธุงู EDR Agent

## ูุธุฑุฉ ุนุงูุฉ

ูุดุฑูุน Rasheed ูู ูุธุงู ูุฑุงูุจุฉ ุฃูููุฉ ุนุงูู ุงูุฃุฏุงุก ูุตูู ูุชุญููู ุจูุงูุงุช ุงูููุงุณ ุนู ุจูุนุฏ ุงูุฎุงู ูู Sysmon ุฅูู ุชูุณูู Elastic Common Schema ุงูููุญุฏ (ECS). ูุทุจู ุงููุธุงู ุจููุฉ ูุนูุงุฑูุฉ ูุชุทูุฑุฉ ูุงุฆูุฉ ุนูู ููุท ุงูููุชุฌ ูุงููุณุชููู (Producer-Consumer) ุจุงุณุชุฎุฏุงู ูููุงุช ูุญุฏูุฏุฉ ุงูุณุนุฉ ููุนุงูุฌุฉ ุงูุฃุญุฏุงุซ ุจุดูู ููุซูู ููุงุจู ููุชูุณุน.

## ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

- โ **ูุฑุงุกุฉ ูุจุงุดุฑุฉ ูู Windows Event Log** - ูุชุตู ูุจุงุดุฑุฉ ุจุณุฌู ุฃุญุฏุงุซ Sysmon ุฏูู ุงูุญุงุฌุฉ ููููุงุช ูุณูุทุฉ
- โ **ูุนุงูุฌุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท** - ูุฌููุนุฉ ุนูุงู ูุงุจูุฉ ููุชูููู ููุนุงูุฌุฉ ุงูุฃุญุฏุงุซ ุจุดูู ูุชุฒุงูู
- โ **ุชุญููู ุฅูู ECS** - ุชุญููู ุชููุงุฆู ูุฃุญุฏุงุซ Sysmon ุฅูู ุชูุณูู Elastic Common Schema ุงูููุญุฏ
- โ **ูุนุงูุฌุฉ ุฏูุนูุฉ** - ุชุญุณูู ุงูุฃุฏุงุก ูู ุฎูุงู ุงููุชุงุจุฉ ุงูุฏูุนูุฉ ููุฃุญุฏุงุซ
- โ **ุฅุฏุงุฑุฉ ุงูุถุบุท ุงูุนูุณู** - ุขููุงุช ุชููุงุฆูุฉ ูููุน ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุงูุฒุงุฆุฏ
- โ **ุฅููุงู ุณูุณ** - ุฅุบูุงู ุขูู ูุน ุถูุงู ุนุฏู ููุฏุงู ุงูุจูุงูุงุช

## ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
โโโโโโโโโโโโโโโโโโโ
โ Windows Event   โ
โ Log (Sysmon)    โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ SysmonCollector โ
โ (XML Parser)    โ
โโโโโโฌโโโโโโโโฌโโโโโ
     โ       โ
     โผ       โผ
โโโโโโโ   โโโโโโโ
โ Raw โ   โNorm โ  Channels
โChan โ   โChan โ  (Bounded)
โโโโฌโโโ   โโโโฌโโโ
   โ         โ
   โผ         โผ
โโโโโโโ   โโโโโโโโโโโโโโโ
โ Raw โ   โNormalizationโ
โWriteโ   โWorker Pool  โ
โโโโโโโ   โโโโโโโโฌโโโโโโโ
                 โ
                 โผ
          โโโโโโโโโโโโโโโ
          โ ECS Writer  โ
          โโโโโโโโโโโโโโโ
```

## ูุชุทูุจุงุช ุงููุธุงู

- **ูุธุงู ุงูุชุดุบูู**: Windows 10/11 ุฃู Windows Server 2016+
- **.NET Runtime**: .NET 8.0 ุฃู ุฃุญุฏุซ
- **Sysmon**: ูุฌุจ ุชุซุจูุช ูุชูููู Sysmon ุนูู ุงููุธุงู
- **ุงูุตูุงุญูุงุช**: ุตูุงุญูุงุช ุงููุณุคูู ููุฑุงุกุฉ ุณุฌูุงุช ุงูุฃุญุฏุงุซ

## ุงูุชุซุจูุช

### 1. ุงุณุชูุณุงุฎ ุงููุณุชูุฏุน

```bash
git clone https://github.com/Edrplatform/Rasheed.git
cd Rasheed/EDR_agent
```

### 2. ุจูุงุก ุงููุดุฑูุน

```bash
dotnet build EDR_agent.sln
```

### 3. ุชุดุบูู ุงูุชุทุจูู

```bash
# ูุถุน ุงูุชุทุจูุน ููุท (ุงูุชุฑุงุถู)
dotnet run

# ูุถุน ุงูุฌูุน ููุท
dotnet run -- --collect

# ูุถุน ูุชูุงูู (ุฌูุน + ุชุทุจูุน)
dotnet run -- --both
```

## ุงูุชูููู

ูููู ุชุฎุตูุต ุณููู ุงููุธุงู ุนุจุฑ ููู `agent_config.json` ูู ุงููุณุงุฑ:
```
%APPDATA%\EDRAgent\agent_config.json
```

ูุซุงู ุนูู ููู ุงูุชูููู:

```json
{
  "BatchSize": 50,
  "FlushIntervalMs": 2000,
  "ChannelCapacity": 1000,
  "WorkerCount": 2
}
```

## ุงููุซุงุฆู

### ๐ ุงููุซุงุฆู ุงููุงููุฉ

ููุญุตูู ุนูู ุฏููู ุชููู ุดุงูู ุญูู ุจููุฉ ุงููุธุงู ูุขููุงุช ุงูุชูููุฐุ ุฑุงุฌุน:

**[๐ ูุซุงุฆู EDR Agent ุงููุงููุฉ (ุนุฑุจู)](EDR_agent/README.MD)**

ุชุชุถูู ุงููุซููุฉ:
- ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุจููุฉ ุงููุนูุงุฑูุฉ
- ููุงุตูุงุช ุงูููููุงุช ุงูุชูุตูููุฉ
- ุฃูุซูุฉ ุชุญููู ุงูุฃุญุฏุงุซ
- ูุฎุทุทุงุช ุชุฏูู ุงูุจูุงูุงุช
- ุฏููู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
- ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

### ๐ ูุซุงุฆู ุฅุถุงููุฉ

- [ูุซุงุฆู ุชูููููุฉ](EDR_agent/Docs/completion_sections.md) - ุฃูุณุงู ุฅุถุงููุฉ ููุนูููุงุช ุชูููููุฉ
- [ูุซุงุฆู ุฅูุฌููุฒูุฉ](EDR_agent/Docs/edr_agent_docs_en.md) - ูุณุฎุฉ ุฅูุฌููุฒูุฉ ูู ุงููุซุงุฆู

## ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ูุซุงู 1: ุฌูุน ุงูุฃุญุฏุงุซ ูู Sysmon

```bash
# ุชุดุบูู ูู ูุถุน ุงูุฌูุน ููุท
EDR_agent.exe --collect
```

ุณูููู ุงููุธุงู ุจูุฑุงุกุฉ ุงูุฃุญุฏุงุซ ูู Windows Event Log ูุญูุธูุง ูู:
```
%APPDATA%\EDRAgent\events.jsonl
```

### ูุซุงู 2: ุชุทุจูุน ุงูุฃุญุฏุงุซ ุงูููุฌูุฏุฉ

```bash
# ุชุดุบูู ูู ูุถุน ุงูุชุทุจูุน ููุท (ุงูุชุฑุงุถู)
EDR_agent.exe
```

ุณูููู ุงููุธุงู ุจูุฑุงุกุฉ ูู `events.jsonl` ูุฅูุดุงุก:
```
%APPDATA%\EDRAgent\events_normalized_ecs.jsonl
```

### ูุซุงู 3: ูุถุน ูุชูุงูู

```bash
# ุฌูุน ูุชุทุจูุน ูู ููุณ ุงูููุช
EDR_agent.exe --both
```

## ุฃููุงุน ุงูุฃุญุฏุงุซ ุงููุฏุนููุฉ

| Event ID | ุงูููุน | ุงููุตู |
|----------|-------|-------|
| 1 | Process Create | ุฅูุดุงุก ุนูููุฉ ุฌุฏูุฏุฉ |
| 3 | Network Connect | ุงุชุตุงู ุดุจูู |
| 11 | File Create | ุฅูุดุงุก ููู |
| 13 | Registry Event | ุชุนุฏูู ุงูุณุฌู |
| 22 | DNS Query | ุงุณุชุนูุงู DNS |

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "Access Denied"

**ุงูุญู**: ุชุดุบูู ุงูุชุทุจูู ุจุตูุงุญูุงุช ุงููุณุคูู

```bash
# ูู PowerShell ููุณุคูู
.\EDR_agent.exe
```

### ุงููุดููุฉ: ูุง ุชูุฌุฏ ุฃุญุฏุงุซ

**ุงูุญู**: ุงูุชุญูู ูู ุชุซุจูุช Sysmon

```powershell
Get-Service Sysmon64
Get-WinEvent -LogName "Microsoft-Windows-Sysmon/Operational" -MaxEvents 10
```

## ุงููุณุงููุฉ

ูุฑุญุจ ุจุงููุณุงููุงุช! ูุฑุฌู:

1. Fork ุงููุณุชูุฏุน
2. ุฅูุดุงุก ูุฑุน ููููุฒุฉ ุงูุฌุฏูุฏุฉ (`git checkout -b feature/AmazingFeature`)
3. Commit ุงูุชุบููุฑุงุช (`git commit -m 'Add some AmazingFeature'`)
4. Push ุฅูู ุงููุฑุน (`git push origin feature/AmazingFeature`)
5. ูุชุญ Pull Request

## ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช [MIT License](LICENSE)

## ุงูุงุชุตุงู

ููุฃุณุฆูุฉ ูุงูุฏุนูุ ูุฑุฌู ูุชุญ Issue ูู ุงููุณุชูุฏุน.

---

<div align="center">

**ุตููุน ุจู โค๏ธ ูุชุญุณูู ุงูุฃูู ุงูุณูุจุฑุงูู**

</div>

</div>
